port: 7890 # HTTP ä»£ç†ç«¯å£
socks-port: 7891 # Socks ç«¯å£
redir-port: 7892 # Redir ç«¯å£
mixed-port: 7893 # æ··åˆç«¯å£
allow-lan: true # å…è®¸å±€åŸŸç½‘è¿æ¥
bind-address: "*" # åœ°å€ç»‘å®š
mode: rule # è§„åˆ™æ¨¡å¼
log-level: info # æ—¥å¿—çº§åˆ«
ipv6: true # IPV6å¼€å…³
external-controller: 127.0.0.1:9090

dns:
  enable: true # ä¸ä½¿ç”¨ç³»ç»Ÿ DNS
  ipv6: true # å¼€å¯ IPV6
  listen: 0.0.0.0:53 # dns ç›‘å¬
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - "*.lan"
    - localhost.ptlogin2.qq.com
    - +.srv.nintendo.net
    - +.stun.playstation.net
    - +.msftconnecttest.com
    - +.msftncsi.com
    - +.xboxlive.com
    - msftconnecttest.com
    - xbox.*.microsoft.com
    - "*.battlenet.com.cn"
    - "*.battlenet.com"
    - "*.blzstatic.cn"
    - "*.battle.net"
  nameserver: # é»˜è®¤ DNS æœåŠ¡
    - 223.5.5.5
    - 119.29.29.29
  fallback: # å›½å¤– DNS æœåŠ¡å™¨
    - https://cloudflare-dns.com/dns-query
    - https://dns.google/dns-query
    - https://dns.alidns.com/dns-query
  fallback-filter:
    geoip: true
    geoip-code: CN
    ipcidr:
      - 240.0.0.0/4
#========= å»ºç«‹é”šç‚¹ =========#

# ç­–ç•¥ç»„å¼•ç”¨
pr: &a3 { type: select, proxies: [ğŸš€ æ‰‹åŠ¨åˆ‡æ¢, ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹, ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹, ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹, DIRECT] }
p: &a1 { type: http, interval: 86400, health-check: { enable: true, url: http://www.gstatic.com/generate_204, interval: 1800 } }
auto: &a4 { type: url-test, lazy: true, url: http://www.gstatic.com/generate_204, interval: 900, use: [Sub] }
use: &a2 { type: select, use: [Sub] }
c: &a6 { type: http, behavior: classical, interval: 86400 }
d: &a5 { type: http, behavior: domain, interval: 86400 }
i: &a7 { type: http, behavior: ipcidr, interval: 86400 }

proxies:
  - name: "ğŸ« cuhksz" # èŠ‚ç‚¹åå­—ï¼Œå¯ä»¥è‡ªå·±å–
    type: socks5 # ä»£ç†ç±»å‹ï¼Œocproxy -D åˆ›å»ºçš„æ˜¯ socks5
    server: 127.0.0.1 # æœåŠ¡å™¨åœ°å€ï¼Œå°±æ˜¯æœ¬æœº
    port: 11080 # ç«¯å£å·ï¼Œå¿…é¡»å’Œä½ å‘½ä»¤ä¸­ -D 11080 è®¾ç½®çš„ä¸€è‡´
    udp: true # å¼ºçƒˆå»ºè®®å¼€å¯ï¼Œå…¼å®¹æ€§æ›´å¥½

proxy-providers:
  Sub:
    <<: *a1
    url:
    # URLåé¢å¡«å†™æ ¼å¼: ç›´æ¥å¡«å†™ä½ çš„æœºåœºClashè®¢é˜…[æ¨èæ­¤ç§æ–¹å¼ï¼Œé¿å…è®¢é˜…æ³„éœ²]
    path: ./proxy_providers/sub.yaml

proxy-groups:
  #åˆ†æµåˆ†ç»„
  - { name: ğŸš€ æ‰‹åŠ¨åˆ‡æ¢, <<: *a2 }
  - { name: ğŸŒ å…¨çƒåŠ é€Ÿ, <<: *a3 }
  - { name: ğŸ è‹¹æœæœåŠ¡, <<: *a3 }
  - { name: ğŸ¨ Adobe, type: select, proxies: [DIRECT, ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹] }
  - { name: ğŸ“º å“”å“©å“”å“©, type: select, proxies: [DIRECT, ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹] }
  - { name: ğŸ¤– Ai, type: select, proxies: [ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹] }
  - { name: ğŸµ Spotify, type: select, proxies: [ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹] }
  - { name: ğŸŒŒ è°·æ­ŒæœåŠ¡, <<: *a3 }
  - { name: ğŸ“Ÿ ç”µæŠ¥æ¶ˆæ¯, <<: *a3 }
  - { name: ğŸ¦ æ¨ç‰¹æœåŠ¡, <<: *a3 }
  - { name: ğŸ® æ¸¸æˆå¹³å°, <<: *a3 }
  - { name: ğŸ† AdBlock, type: select, proxies: [REJECT] }
  - { name: ğŸŸ å…œåº•åˆ†æµ, <<: *a3 }

  #èŠ‚ç‚¹åˆ†ç»„
  - { name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹, <<: *a2, filter: "(?i)æ¸¯|hk|hong" } # a4æ›´æ”¹ä¸ºa2ï¼Œå³ä¸ºæ‰‹åŠ¨é€‰æ‹©
  - { name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹, <<: *a2, filter: "(?i)æ—¥æœ¬|ä¸œäº¬|jp|japan" } # a4æ›´æ”¹ä¸ºa2ï¼Œå³ä¸ºæ‰‹åŠ¨é€‰æ‹©
  - { name: ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹, <<: *a2, filter: "(?i)å°|æ¹¾|tw|taiwan" } # a4æ›´æ”¹ä¸ºa2ï¼Œå³ä¸ºæ‰‹åŠ¨é€‰æ‹©
  - { name: ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹, <<: *a2, filter: "(?i)ç¾å›½|us|states|american" } # a4æ›´æ”¹ä¸ºa2ï¼Œå³ä¸ºæ‰‹åŠ¨é€‰æ‹©
  - { name: ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹, <<: *a2, filter: "(?i)æ–°åŠ å¡|ç‹®åŸ|sg|singapore" } # a4æ›´æ”¹ä¸ºa2ï¼Œå³ä¸ºæ‰‹åŠ¨é€‰æ‹©
  - name: "ğŸ“ æ ¡å†…ä¸“çº¿" # æ–°å»ºä¸€ä¸ªç­–ç•¥ç»„
    type: select
    proxies:
      - "ğŸ« cuhksz" # æŠŠæ–°èŠ‚ç‚¹æ”¾è¿›æ¥
      - DIRECT # åŠ ä¸Šç›´è¿ä½œä¸ºå¤‡ç”¨

# åˆ†æµè§„åˆ™
rule-providers:
  Ad: { <<: *a5, url: https://raw.githubusercontent.com/Cats-Team/AdRules/main/adrules_domainset.txt, path: ./ruleset/anti-ad-clash.yaml }
  Ai: { <<: *a6, url: https://gist.githubusercontent.com/ddgksf2013/cb4121e8b5c5d865cc949cb8120320c4/raw/Ai.yaml, path: ./ruleset/Ai.yaml }
  Adobe: { <<: *a6, url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Adobe/Adobe.yaml, path: ./ruleset/Adobe.yaml }
  BiliBili: { <<: *a6, url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/BiliBili/BiliBili.yaml, path: ./ruleset/BiliBili.yaml }
  Apple: { <<: *a6, url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Apple/Apple_Classical.yaml, path: ./ruleset/Apple.yaml }
  Github: { <<: *a6, url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/GitHub/GitHub.yaml, path: ./ruleset/Github.yaml }
  Microsoft: { <<: *a6, url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Microsoft/Microsoft.yaml, path: ./ruleset/Microsoft.yaml }
  Google: { <<: *a6, url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Google/Google.yaml, path: ./ruleset/Google.yaml }
  Telegram: { <<: *a6, url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Telegram/Telegram.yaml, path: ./ruleset/Telegram.yaml }
  Twitter: { <<: *a6, url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Twitter/Twitter.yaml, path: ./ruleset/Twitter.yaml }
  Game: { <<: *a6, url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Game/Game.yaml, path: ./ruleset/Game.yaml }
  ProxyLite: { <<: *a6, url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/ProxyLite/ProxyLite.yaml, path: ./ruleset/ProxyLite.yaml }
  Direct: { <<: *a6, url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Direct/Direct.yaml, path: ./ruleset/Direct.yaml }
  Lan: { <<: *a6, url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Lan/Lan.yaml, path: ./ruleset/Lan.yaml }
  Download: { <<: *a6, url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Download/Download.yaml, path: ./ruleset/Download.yaml }
  ChinaIP: { <<: *a7, url: https://cdn.jsdelivr.net/gh/soffchen/GeoIP2-CN@release/clash-rule-provider.yml, path: ./ruleset/ChinaIP.yaml }
  School: { <<: *a6, url: https://raw.githubusercontent.com/Carsonn-Chen/cuhksz_clash/refs/heads/main/School_Rules.yaml, path: ./ruleset/School.yaml }
  Journal: { <<: *a6, url: https://cdn.jsdelivr.net/gh/Carsonn-Chen/cuhksz_clash@main/Academic_Journal.yaml, path: ./ruleset/Journal.yaml }

# åˆ†æµPolicy
rules:
  - DST-PORT,22,DIRECT
  - DOMAIN,vpn.cuhk.edu.cn,DIRECT
  - RULE-SET,School,ğŸ“ æ ¡å†…ä¸“çº¿
  - RULE-SET,Journal,ğŸ“ æ ¡å†…ä¸“çº¿
  - RULE-SET,Ad,ğŸ† AdBlock
  - RULE-SET,Ai,ğŸ¤– Ai
  - RULE-SET,Adobe,ğŸ¨ Adobe
  - RULE-SET,BiliBili,ğŸ“º å“”å“©å“”å“©
  - RULE-SET,Apple,ğŸ è‹¹æœæœåŠ¡
  - RULE-SET,Github,ğŸŒ å…¨çƒåŠ é€Ÿ
  - RULE-SET,Microsoft, DIRECT
  - RULE-SET,Google,ğŸŒŒ è°·æ­ŒæœåŠ¡
  - RULE-SET,Telegram,ğŸ“Ÿ ç”µæŠ¥æ¶ˆæ¯
  - RULE-SET,Twitter,ğŸŒ å…¨çƒåŠ é€Ÿ
  - RULE-SET,Game,ğŸ® æ¸¸æˆå¹³å°
  - RULE-SET,ProxyLite,ğŸŒ å…¨çƒåŠ é€Ÿ
  - RULE-SET,Direct,DIRECT
  - RULE-SET,Lan,DIRECT
  - RULE-SET,Download,DIRECT
  - RULE-SET,ChinaIP,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,ğŸŸ å…œåº•åˆ†æµ
